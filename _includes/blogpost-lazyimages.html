{% comment %}
    Version 1.1.0
        https://github.com/allejo/jekyll-toc

    "...like all things liquid - where there's a will, and ~36 hours to spare, there's usually a/some way" ~jaybe

    Usage:
        {% include lazyimages.html html=content %}

    Parameters:
        * html         (string) - the HTML of compiled markdown generated by kramdown in Jekyll

    Output:
        The HTML content compiled by kramdown with images tag updated to be load lazyly.
{% endcomment %}
{%- assign excerpt = content | split: '<img src="' -%}
{%- for e in excerpt -%}
	{%- if forloop.first == true -%}
		{{ e }}
	{%- else -%}
		{%- if e contains '" alt="' -%}
			{%- assign f = e | split: '" alt="' -%}
			{%- assign url = f | first -%}
			{%- assign g = f | shift | join: '" alt="' | split: '"' -%}
			{%- assign alt = g | first -%}
			{%- assign rest = g | shift | join: '"' -%}
			<img src="{{ url }}" alt="{{ alt }}" loading="lazy"{{ rest }}
            {%- else -%}
			{%- assign f = e | split: '"' -%}
			{%- assign url = f | first -%}
			{%- assign rest = f | shift | join: '"' -%}
			<img src="{{ url }}" loading="lazy"{{ rest }}
		{%- endif -%}
	{%- endif -%}
{%- endfor -%}